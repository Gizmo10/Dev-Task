<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test My API ENDPOINT</title>
  </head>
  <body>
    <header>
      <h1>Let's test my endpoint!</h1>
    </header>

    <section>
      <form>
        <label for="url">
          <input
            type="text"
            name="url"
            id="url"
            placeholder="type in your url endpoint"
            required
          />
        </label>

        <label for="email">
          <input
            type="email"
            name="email"
            id="email"
            placeholder="type in your email"
            required
          />
        </label>

        <label for="result">
          <input
            type="textarea"
            name="result"
            id="result"
            rows="5"
            cols="100"
          />
        </label>
        <input type="submit" id="submit" />
      </form>
    </section>

    <footer></footer>
    <script>
      const urlElement = document.getElementById("url");
      const emailElement = document.getElementById("email");
      const resultElement = document.getElementById("result");
      const submitButton = document.getElementById("submit");

      submitButton.onclick = async (event) => {
        event.preventDefault();
        const urlValue = urlElement.value;
        const emailValue = emailElement.value;
        const url = `https://yhxzjyykdsfkdrmdxgho.supabase.co/functions/v1/junior-dev?url=${urlValue}&email=${emailValue}`;

        try {
          const response = await fetch(url, {
            headers: {
              "Content-Type": "application/json",
            },
          });

          if (!response.ok) {
            throw new Error(`HTTP Error: ${response.status}`);
          }

          const result = await response.json();
          console.log(result);
          resultElement.textContent(result);
        } catch (error) {
          throw new Error(`Failed to fetch: ${error.message}`);
        }
      };
    </script>
  </body>
</html>
